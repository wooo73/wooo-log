# 정규화

---

정규화(Normalization)의 기본 목표는 테이블 간에 중복된 데이터를 허용하지 않는다는 것이다. 중복된 데이터를 허용하지 않음으로써 무결성(Integrity)를 유지할 수 있으며, DB의 저장 용량 역시 줄일 수 있다.

## 제1 정규형

---

**테이블의 컬럼이 하나의 원자적 값만을 가지도록 분해하는 것이다.**

원자적 값이란 더 이상 분해할 수 없는 단일 값을 의미한다.

| 회원번호 | 회원이름 | 프로그램       |
| -------- | -------- | -------------- |
| 101      | 강호동   | 스쿼시초급     |
| 102      | 손흥민   | 헬스           |
| 103      | 김민수   | 헬스           |
| 103      | 김민수   | 헬스, 골프초급 |

수강 등록 현황 테이블

-   김민수는 2개의 프로그램을 가지고 있기 때문에 제1 정규형을 만족하지 못하고 있다.
    -   조회시 where 조건에 like 연산자와 같은 함수를 사용하여야 한다.
    -   데이터 수정, 삭제 또한 추가 작업이 필요하다.
-   이와 같은 경우 다음과 같이 기존 레코드를 분리하여 제1 정규형을 만족시킬 수 있다.

| 회원번호 | 회원이름 | 프로그램   |
| -------- | -------- | ---------- |
| 101      | 강호동   | 스쿼시초급 |
| 102      | 손흥민   | 헬스       |
| 103      | 김민수   | 헬스       |
| 103      | 김민수   | 골프초급   |

-   where 조건에 특별한 함수를 사용하지 않아도 조회가 가능하다.
-   데이터 수정, 삭제 또한 추가 작업이 필요하지 않다.

## 제2 정규형

---

### 제2 정규형 기본

**현재 테이블의 주제와 관련없는 컬럼을 분해하는 것이다.**

| 회원번호 | 회원이름 | 프로그램   | 가격 | 납부여부 |
| -------- | -------- | ---------- | ---- | -------- |
| 101      | 강호동   | 스쿼시초급 | 5000 | 0        |
| 102      | 손흥민   | 헬스       | 6000 | 1        |
| 103      | 김민수   | 헬스       | 6000 | 1        |
| 103      | 김민수   | 골프초급   | 8000 | 0        |

수강 등록 현황 테이블

-   수강 등록 현황 테이블에서 프로그램의 가격은 주제와 맞지 않는다.
    -   헬스 프로그램이 7000원으로 오른 경우에 모든 헬스 컬럼의 가격을 변경해야 한다.
-   이와 같은 경우 다음과 같이 기존 테이블에서 분리하여 제2 정규형을 만족시킬 수 있다.

| 회원번호 | 회원이름 | 프로그램   | 납부여부 |
| -------- | -------- | ---------- | -------- |
| 101      | 강호동   | 스쿼시초급 | 0        |
| 102      | 손흥민   | 헬스       | 1        |
| 103      | 김민수   | 헬스       | 1        |
| 103      | 김민수   | 골프초급   | 0        |

| 프로그램    | 가격 |
| ----------- | ---- |
| 스쿼시 초급 | 5000 |
| 헬스        | 6000 |
| 골프초급    | 8000 |

-   프로그램의 가격이 변경될 경우 프로그램 테이블만 수정해주면 된다.
-   이렇게 분리할 경우 회원이 납부해야하는 프로그램 가격을 확인하기 위해선 2개의 테이블을 조회해야 한다.

### 제2 정규형 심화

**제1 정규형을 만족하고, 비주요 속성이 기본키에 완전 함수적으로 종속될 때 까지 분해하는 것이다.**

-   완전 함수 종속이라는 것은 기본키의 부분집합이 결정자가 되어선 안된다는 것을 의미한다.
    -   이를 통해 부분 함수적 종속성을 제거한다.

| 회원번호 | 회원이름 | 프로그램   | 가격 | 납부여부 |
| -------- | -------- | ---------- | ---- | -------- |
| 101      | 강호동   | 스쿼시초급 | 5000 | 0        |
| 102      | 손흥민   | 헬스       | 6000 | 1        |
| 103      | 김민수   | 헬스       | 6000 | 1        |
| 103      | 김민수   | 골프초급   | 8000 | 0        |

수강 등록 현황 테이블

-   위 테이블은 기본키가 (회원번호, 프로그램)으로 복합키이다.
    -   기본키는 납부여부를 결정하고 있다.
-   회원이름의 경우 기본키의 부분집합인 회원번호에 의해 결정된다. (회원번호) -> (회원이름)
-   가격의 경우 기본키의 부분집합인 프로그램에 의해 결정된다. (프로그램) -> (가격)
-   이와 같은 경우 다음과 같이 기존 테이블에서 분리하여 제2 정규형을 만족시킬 수 있다.

| 회원번호 | 프로그램   | 납부여부 |
| -------- | ---------- | -------- |
| 101      | 스쿼시초급 | 0        |
| 102      | 헬스       | 1        |
| 103      | 헬스       | 1        |
| 103      | 골프초급   | 0        |

| 프로그램    | 가격 |
| ----------- | ---- |
| 스쿼시 초급 | 5000 |
| 헬스        | 6000 |
| 골프초급    | 8000 |

| 회원번호 | 회원이름 |
| -------- | -------- |
| 101      | 강호동   |
| 102      | 손흥민   |
| 103      | 김민수   |

## 제3 정규형

---

**제2 정규형을 만족하고, 모든 비주요 속성이 기본키에 이행적으로 종속되지 않을 때 까지 분해하는 것이다.**

-   이행적 종속이란 A -> B이고 B -> C일 때, A -> C가 성립하는 관계를 말한다. 즉, A가 B를 결정하고, B가 C를 결정할 때, A가 간접적으로 C를
    결정하는 관계.

| 프로그램 | 가격 | 강사   | 출신대학 |
| -------- | ---- | ------ | -------- |
| 스쿼시   | 5000 | 김을용 | 서울대   |
| 헬스     | 6000 | 박덕팔 | 연세대   |
| 골프     | 8000 | 이상구 | 고려대   |
| 골프중급 | 9000 | 이상구 | 고려대   |
| 개인피티 | 6000 | 박덕팔 | 연세대   |

프로그램 정보 테이블

-   프로그램 -> 가격 (프로그램이 가격을 결정)
-   프로그램 -> 강사 (프로그램이 강사를 결정)
-   강사 → 출신대학 (강사가 출신대학을 결정)

여기서 이행적 종속은: 프로그램 → 강사 → 출신대학
**즉, 프로그램이 강사를 결정하고, 강사가 출신대학을 결정하므로, 프로그램이 간접적으로 출신대학을 결정하는 관계가 성립된다.**

-   같은 강사가 여러 프로그램을 담당할 때, 강사의 출신대학 정보가 중복되어 저장되므로, 출신대학 정보를 변경할 때 여러 레코드를 수정해야 한다.
-   이와 같은 경우 다음과 같이 기존 테이블에서 분리하여 제3 정규형을 만족시킬 수 있다.

| 프로그램 | 가격 | 강사   |
| -------- | ---- | ------ |
| 스쿼시   | 5000 | 김을용 |
| 헬스     | 6000 | 박덕팔 |
| 골프     | 8000 | 이상구 |
| 골프중급 | 9000 | 이상구 |
| 개인피티 | 6000 | 박덕팔 |

| 강사   | 출신대학 |
| ------ | -------- |
| 김을용 | 서울대   |
| 박덕팔 | 연세대   |
| 이상구 | 고려대   |

## BCNF (Boyce-Codd 정규형)

---

**모든 결정자가 후보키가 되도록 테이블을 분해하는 것이다.**

BCNF는 제3 정규형보다 더 엄격한 정규형으로, 모든 결정자(Determinant)가 후보키(Candidate Key)가 되어야 한다.

| 학생   | 과목         | 교수   |
| ------ | ------------ | ------ |
| 김철수 | 데이터베이스 | 박교수 |
| 이영희 | 알고리즘     | 정교수 |
| 홍길동 | 데이터베이스 | 박교수 |

-   (학생, 과목)이 기본키이다.
-   과목 -> 교수 (한 과목은 한 명의 교수만 담당)
-   교수 -> 과목 (한 교수는 한 과목만 담당)

여기서 교수는 결정자이지만 후보키가 아니므로 BCNF를 만족하지 않는다. BCNF를 만족하도록 분해하면:

| 교수   | 과목         |
| ------ | ------------ |
| 박교수 | 데이터베이스 |
| 정교수 | 알고리즘     |

| 학생   | 교수   |
| ------ | ------ |
| 김철수 | 박교수 |
| 이영희 | 정교수 |
| 홍길동 | 박교수 |

## 정규화의 장단점

---

**장점**

-   데이터 중복 감소
-   데이터 일관성 유지
-   데이터 갱신 이상(Anomaly) 방지
-   데이터베이스 구조 확장 시 재설계 최소화

**단점**

-   조인 연산 증가로 인한 성능 저하 가능성
-   복잡한 쿼리 작성 필요
-   설계 과정이 복잡해짐

## 결론

---

-   제1 정규형

    -   모든 속성이 원자적 값을 가짐

-   제2 정규형

    -   제1 정규형을 만족
    -   부분 함수적 종속성 제거
    -   기본키의 부분집합에 종속된 속성 분리

-   제3 정규형

    -   제2 정규형을 만족
    -   이행적 종속 제거
    -   A -> B -> C 관계 분리

-   BCNF
    -   제3 정규형을 만족
    -   모든 결정자가 후보키가 됨

## 참고자료

---

-   https://mangkyu.tistory.com/110
-   https://youtu.be/Y1FbowQRcmI?si=GoyAuc1vo4BqRxmt
